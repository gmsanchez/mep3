#VRML_SIM R2022a utf8
# template language: javascript

PROTO RobotMemristor [
  field SFString   name               "test_robot"
  field SFVec3f    translation        0 0 0
  field SFRotation rotation           0 1 0 0
  field SFString   controller         "test_robot"
  field SFFloat    mass_robot         2
  field SFFloat    mass_motor_wheel   0.05
  field SFFloat    mass_encoder_wheel 0.05
  field SFFloat    mass_arm_base      0.2
  field SFFloat    mass_arm_mid1      0.15
  field SFFloat    mass_arm_mid2      0.3
  field SFFloat    mass_arm_gripper   0.1
  hiddenField SFFloat motor_wheel_radius 0.036
  hiddenField SFFloat motor_wheel_height 0.035
  hiddenField SFFloat motor_wheel_distance 0.143
  hiddenField SFFloat encoder_wheel_radius 0.0375
  hiddenField SFFloat encoder_wheel_height 0.007
  hiddenField SFFloat encoder_wheel_distance 0.287
  hiddenField SFFloat arm_x 0.075
  hiddenField SFFloat arm_y 0.132
  hiddenField SFFloat arm_z 0.063
  hiddenField SFFloat robot_x_size 0.2
  hiddenField SFFloat robot_y_size 0.3
  hiddenField SFFloat robot_z_size 0.335
  hiddenField SFFloat robot_height 0.013
  hiddenField SFFloat robot_plate_width 0.005
]
{
Robot {
  translation IS translation
  rotation IS rotation
  name IS name
  controller IS controller
  children [
            DEF leva_sisaljka Connector {
              translation 0.053 0.1246 0.2024
                }
            DEF desna_sisaljka Connector {
              translation 0.053 -0.1246 0.2024
                }
            DEF left_hand_G Transform {
              translation -0.0328 0.1292 0.1526
                children [
                          HingeJoint {
                            jointParameters HingeJointParameters {
                            }
                            device [
                                    RotationalMotor {
                                      name "left_hand_G"
                                        }
                                    ]
                              endPoint Solid {
                              children [
                                        Shape {
                                          appearance PBRAppearance {
                                            baseColor 0.8 0 0
                                              }
                                          geometry Mesh {
                                            url [
                                                 "assets/meshes/hands/hand_G.obj"
                                                 ]
                                              }
                                        }
                                        ]
                                boundingObject Transform {
                                translation 0.0015 0 0.024
                                  children [
                                            Box {
                                              size 0.048 0.011 0.11
                                                }
                                            ]
                                  }
                              physics Physics {
                              }
                            }
                          }
                          ]
                }

            DEF right_hand_G Transform {
              translation -0.0328 -0.1292 0.1526
                children [
                          HingeJoint {
                            jointParameters HingeJointParameters {
                            }
                            device [
                                    RotationalMotor {
                                      name "right_hand_G"
                                        }
                                    ]
                              endPoint Solid {
                              children [
                                        Shape {
                                          appearance PBRAppearance {
                                            baseColor 0.8 0 0
                                              }
                                          geometry Mesh {
                                            url [
                                                 "assets/meshes/hands/hand_G.obj"
                                                 ]
                                              }
                                        }
                                        ]
                                boundingObject Transform {
                                translation 0.0015 0 0.024
                                  children [
                                            Box {
                                              size 0.048 0.011 0.11
                                                }
                                            ]
                                  }
                              physics Physics {
                              }
                            }
                          }
                          ]
                }


    DEF middle_hand Transform {
      translation -0.0868 0 0.2195
      children [
        HingeJoint {
          jointParameters HingeJointParameters {
            axis 0 1 0
          }
          device [
            RotationalMotor {
              name "middle_hand"
            }
          ]
          endPoint Solid {
            children [
              DEF pokretni_deo Shape {
                appearance PBRAppearance {
                  baseColor 0.8 0 0
                }
                geometry Mesh {
                  url [
                    "assets/meshes/hands/hand_mid.obj"
                  ]
                }
              }
            ]
            name "solid(2)"
            boundingObject Transform {
              translation -0.0092 0 -0.07
              children [
                Box {
                  size 0.01 0.183 0.05
                }
              ]
            }
            physics Physics {
            }
          }
        }
        DEF staticni_deo Shape {
          appearance PBRAppearance {
            baseColor 0.8 0 0
          }
          geometry Mesh {
            url [
                 "assets/meshes/hands/static_mid.obj"
            ]
          }
        }
      ]
    }


            DEF left_hand_Dz Transform {
              translation -0.0314 0.1296 0.13
                children [
                          HingeJoint {
                            jointParameters HingeJointParameters {
                            }
                            device [
                                    RotationalMotor {
                                      name "left_hand_Dz"
                                        }
                                    ]
                              endPoint Solid {
                              children [
                                        Shape {
                                          appearance PBRAppearance {
                                            baseColor 0.8 0 0
                                              }
                                          geometry Mesh {
                                            url [
                                                 "assets/meshes/hands/hand_Dz.obj"
                                                 ]
                                              }
                                        }
                                        ]
                                name "solid(2)"
                                boundingObject Transform {
                                translation 0 0 0.0745
                                  children [
                                            Box {
                                              size 0.072 0.02 0.126
                                                }
                                            ]
                                  }
                            }
                          }
                          ]
                }

            DEF right_hand_Dz Transform {
              translation -0.0314 -0.1296 0.13
                children [
                          HingeJoint {
                            jointParameters HingeJointParameters {
                            }
                            device [
                                    RotationalMotor {
                                      name "right_hand_Dz"
                                        }
                                    ]
                              endPoint Solid {
                              children [
                                        Shape {
                                          appearance PBRAppearance {
                                            baseColor 0.8 0 0
                                              }
                                          geometry Mesh {
                                            url [
                                                 "assets/meshes/hands/hand_Dz.obj"
                                                 ]
                                              }
                                        }
                                        ]
                                name "solid(2)"
                                boundingObject Transform {
                                translation 0 0 0.0745
                                  children [
                                            Box {
                                              size 0.072 0.02 0.126
                                                }
                                            ]
                                  }
                            }
                          }
                          ]
                }


    DEF kapa Transform {
      translation -0.0262 0 0.4393
      children [
        Transform {
          translation 0 0 0.0679
          rotation 1 0 0 4.692820414042842e-06
          children [
            Shape {
              appearance PBRAppearance {
                baseColor 0.180392 0.203922 0.211765
                roughness 1
                roughnessMap ImageTexture {
                  url [
                    "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_roughness.jpg"
                  ]
                }
                metalness 0
              }
              geometry Box {
                size 0.1 0.1 0.005
              }
            }
          ]
        }
        Shape {
          appearance PBRAppearance {
            baseColor 0.180392 0.203922 0.211765
            roughness 1
            roughnessMap ImageTexture {
              url [
                "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_roughness.jpg"
              ]
            }
            metalness 0
          }
          geometry Cylinder {
            height 0.135
            radius 0.04
          }
          castShadows FALSE
        }
      ]
    }


    Shape {
      appearance Plastic {
        colorOverride 0.333333 0.341176 0.32549
      }
      geometry Mesh {
        url ["assets/meshes/robot/Robot.obj"]
      }
    }



    Solid {
      translation 0.08 0 0.0075
      children [
        DEF OMNI_SHAPE Shape {
          appearance PBRAppearance {
            baseColorMap ImageTexture {
              url [
                "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/brushed_aluminium/brushed_aluminium_base_color.jpg"
              ]
            }
            roughnessMap ImageTexture {
              url [
                "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/brushed_aluminium/brushed_aluminium_roughness.jpg"
              ]
            }
            normalMap ImageTexture {
              url [
                "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/brushed_aluminium/brushed_aluminium_normal.jpg"
              ]
            }
          }
          geometry Sphere {
            radius 0.007
            subdivision 4
          }
        }
      ]
      name "front_omni_wheel"
      contactMaterial "omni_wheel"
      boundingObject USE OMNI_SHAPE
      physics Physics {
      }
    }
            Solid {
              translation -0.079 0.096 0.0075
                children [
                          USE OMNI_SHAPE
                          ]
                name "rear_omni_wheel_left"
                contactMaterial "omni_wheel"
                boundingObject USE OMNI_SHAPE
                physics Physics {
              }
            }
            Solid {
              translation -0.079 -0.096 0.0075
                children [
                          USE OMNI_SHAPE
                          ]
                name "rear_omni_wheel_right"
                contactMaterial "omni_wheel"
                boundingObject USE OMNI_SHAPE
                physics Physics {
              }
            }

    DEF levi_enkoder Transform {
      translation 0 0.1435 0.0375
      children [
        HingeJoint {
          jointParameters HingeJointParameters {
            axis 0 1 0
          }
          device [
            PositionSensor {
              name "encoder_left"
            }
            RotationalMotor {
              name "left_motor"
              maxVelocity 30
              maxTorque 100
            }
          ]
          endPoint Solid {
            rotation -1 0 0 1.570796
            children [
              Shape {
                appearance PBRAppearance {
                  baseColor 0.933333 0.933333 0.92549
                  roughness 1
                  roughnessMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_roughness.jpg"
                    ]
                  }
                  metalness 0
                  normalMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_normal.jpg"
                    ]
                  }
                }
                geometry Cylinder {
                  height 0.007
                  radius 0.0375
                }
              }
            ]
            name "test_robot_encoder_left_solid(1)"
            contactMaterial "wheel"
            boundingObject DEF ENCODER_WHEEL_BO Cylinder {
              height 0.007
              radius 0.0375
            }
            physics Physics {
              density -1
              mass 0.05
            }
          }
        }
      ]
    }
    DEF desni_enkoder Transform {
      translation 0 -0.1435 0.0375
      children [
        HingeJoint {
          jointParameters HingeJointParameters {
            axis 0 1 0
          }
          device [
            PositionSensor {
              name "encoder_left"
            }
            RotationalMotor {
              name "left_motor"
              maxVelocity 30
              maxTorque 100
            }
          ]
          endPoint Solid {
            rotation -1 0 0 1.570796
            children [
              Shape {
                appearance PBRAppearance {
                  baseColor 0.933333 0.933333 0.92549
                  roughness 1
                  roughnessMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_roughness.jpg"
                    ]
                  }
                  metalness 0
                  normalMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_normal.jpg"
                    ]
                  }
                }
                geometry Cylinder {
                  height 0.007
                  radius 0.0375
                }
              }
            ]
            name "test_robot_encoder_left_solid(2)"
            contactMaterial "wheel"
            boundingObject DEF ENCODER_WHEEL_BO Cylinder {
              height 0.007
              radius 0.0375
            }
            physics Physics {
              density -1
              mass 0.05
            }
          }
        }
      ]
    }
    DEF levi_motor Transform {
      translation 0 0.0715 0.036
      children [
        HingeJoint {
          jointParameters HingeJointParameters {
            axis 0 1 0
          }
          device [
            PositionSensor {
              name "left_encoder_inner"
            }
            RotationalMotor {
              name "left_motor_inner"
              maxVelocity 30
              maxTorque 100
            }
          ]
          endPoint Solid {
            rotation -1 0 0 1.5707996938995745
            children [
              Shape {
                appearance PBRAppearance {
                  baseColor 0.180392 0.203922 0.211765
                  roughness 1
                  roughnessMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_roughness.jpg"
                    ]
                  }
                  metalness 0
                  normalMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_normal.jpg"
                    ]
                  }
                }
                geometry Cylinder {
                  height 0.035
                  radius 0.036
                }
              }
            ]
            name "test_robot_motor_left_solid"
            contactMaterial "wheel"
            boundingObject DEF ENCODER_WHEEL_BO Cylinder {
              height 0.035
              radius 0.036
            }
            physics Physics {
              density -1
              mass 0.05
            }
          }
        }
      ]
    }
    DEF desni_motor Transform {
      translation 0 -0.0715 0.036
      children [
        HingeJoint {
          jointParameters HingeJointParameters {
            axis 0 1 0
          }
          device [
            PositionSensor {
              name "right_encoder_inner"
            }
            RotationalMotor {
              name "right_motor_inner"
              maxVelocity 30
              maxTorque 100
            }
          ]
          endPoint Solid {
            rotation -1 0 0 1.5707996938995745
            children [
              Shape {
                appearance PBRAppearance {
                  baseColor 0.180392 0.203922 0.211765
                  roughness 1
                  roughnessMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_roughness.jpg"
                    ]
                  }
                  metalness 0
                  normalMap ImageTexture {
                    url [
                      "https://raw.githubusercontent.com/cyberbotics/webots/R2022a/projects/appearances/protos/textures/plastic/plastic_rough_normal.jpg"
                    ]
                  }
                }
                geometry Cylinder {
                  height 0.035
                  radius 0.036
                }
              }
            ]
            name "test_robot_motor_left_solid(1)"
            contactMaterial "wheel"
            boundingObject DEF ENCODER_WHEEL_BO Cylinder {
              height 0.035
              radius 0.036
            }
            physics Physics {
              density -1
              mass 0.05
            }
          }
        }
      ]
    }
    RobotArmMemristor {
      name "arm_right"
      translation %<= fields.arm_x.value >% %<= -fields.arm_y.value >% %<= fields.arm_z.value >%
      rotation 0 0 1 1.5708
      mass_base IS mass_arm_base
      mass_mid1 IS mass_arm_mid1
      mass_mid2 IS mass_arm_mid2
      mass_gripper IS mass_arm_gripper
    }
    RobotArmMemristor {
      name "arm_left"
      translation %<= fields.arm_x.value >% %<= fields.arm_y.value >% %<= fields.arm_z.value >%
      rotation 0 0 1 -1.5708
      mass_base IS mass_arm_base
      mass_mid1 IS mass_arm_mid1
      mass_mid2 IS mass_arm_mid2
      mass_gripper IS mass_arm_gripper
    }
    RobotisLds01 {
      translation -0.0262 -0.0008 0.355
    }
  ]
  boundingObject Group {
    children [
      Transform {
        translation %<= -(fields.robot_x_size.value - 2*fields.arm_x.value)/2 >% 0 %<= fields.robot_z_size.value/8 + fields.robot_height.value + fields.robot_plate_width.value/4 >%
        children [
          Box {
            size %<= 2*fields.arm_x.value >% %<= fields.robot_y_size.value >% %<= fields.robot_z_size.value/4 - fields.robot_plate_width.value/2 >%
          }
        ]
      }
      Transform {
        translation 0 0 %<= fields.robot_height.value >%
        children [
          Box {
            size %<= fields.robot_x_size.value >% %<= fields.robot_y_size.value >% %<= fields.robot_plate_width.value >%
          }
        ]
      }
    ]
  }
  physics Physics {
    density -1
    mass IS mass_robot
  }
}
}
